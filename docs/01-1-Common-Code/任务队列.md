**场景说明:**
设计这样一个 Class:

- task.run("task1") -> 输出 "task1"
- task.run("task1").wait(1000).run("task2") -> 输出"task1" 等待 1 秒后，输出 "task2"
- task.run("task1").stop(1000).run("task2") -> 等待 1 秒后,输出 "task1" ,输出 "task2"

分析: _难点在于当 task.run()的时候要执行,但是当后面有 stop 的时候又要不立即执行,解决方法是将 task.run()放到宏任务中._
**代码实现:**

```js
class Task {
  constructor() {
    this.taskArr = [];
    this.timer = null;
    this.CurrentVal = "";
  }
  delay(time) {
    return new Promise((resolve) => {
      setTimeout(() => {
        resolve();
      }, time);
    });
  }
  async exeCute() {
    for (let i = 0; i < this.taskArr.length; i++) {
      let val = this.taskArr[i];
      this.CurrentVal = val;
      //相当于判断是否是任务,是的话宏任务中执行,不是的话等待延迟
      if (typeof val === "string") {
        this.timer = setTimeout(() => {}, 0);
      } else {
        await this.delay(val);
      }
    }

    this.taskArr = [];
  }
  stop(ms) {
    clearTimeout(this.timer);
    this.taskArr.unshift(this.CurrentVal);
    this.taskArr.unshift(ms);
    return this;
  }

  wait(ms) {
    this.taskArr.push(ms);
    return this;
  }
  run(name) {
    this.taskArr.push(name);
    this.exeCute();
    return this;
  }
}
const task = new Task();
task.run("task1").stop(1000).wait(3000).run("111");
```
